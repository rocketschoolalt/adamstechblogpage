// Copyright 2018-2022 the Deno authors. All rights reserved. MIT license.
import { Buffer } from "../buffer.ts";
export const timingSafeEqual = (a, b)=>{
    if (a instanceof DataView) a = Buffer.from(a.buffer);
    if (b instanceof DataView) b = Buffer.from(b.buffer);
    if (a instanceof ArrayBuffer) a = Buffer.from(a);
    if (b instanceof ArrayBuffer) b = Buffer.from(b);
    let result = 0;
    if (a.byteLength !== b.byteLength) {
        b = a;
        result = 1;
    }
    for(let i = 0; i < a.byteLength; i++){
        result |= a[i] ^ b[i];
    }
    return result === 0;
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3N0ZEAwLjE0Ny4wL25vZGUvaW50ZXJuYWxfYmluZGluZy9fdGltaW5nU2FmZUVxdWFsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE4LTIwMjIgdGhlIERlbm8gYXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4gTUlUIGxpY2Vuc2UuXG5pbXBvcnQgeyBCdWZmZXIgfSBmcm9tIFwiLi4vYnVmZmVyLnRzXCI7XG5cbmV4cG9ydCBjb25zdCB0aW1pbmdTYWZlRXF1YWwgPSAoXG4gIGE6IEJ1ZmZlciB8IERhdGFWaWV3IHwgQXJyYXlCdWZmZXIsXG4gIGI6IEJ1ZmZlciB8IERhdGFWaWV3IHwgQXJyYXlCdWZmZXIsXG4pOiBib29sZWFuID0+IHtcbiAgaWYgKGEgaW5zdGFuY2VvZiBEYXRhVmlldykgYSA9IEJ1ZmZlci5mcm9tKGEuYnVmZmVyKTtcbiAgaWYgKGIgaW5zdGFuY2VvZiBEYXRhVmlldykgYiA9IEJ1ZmZlci5mcm9tKGIuYnVmZmVyKTtcbiAgaWYgKGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikgYSA9IEJ1ZmZlci5mcm9tKGEpO1xuICBpZiAoYiBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSBiID0gQnVmZmVyLmZyb20oYik7XG5cbiAgbGV0IHJlc3VsdCA9IDA7XG4gIGlmIChhLmJ5dGVMZW5ndGggIT09IGIuYnl0ZUxlbmd0aCkge1xuICAgIGIgPSBhO1xuICAgIHJlc3VsdCA9IDE7XG4gIH1cblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGEuYnl0ZUxlbmd0aDsgaSsrKSB7XG4gICAgcmVzdWx0IHw9IChhIGFzIEJ1ZmZlcilbaV0gXiAoYiBhcyBCdWZmZXIpW2ldO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdCA9PT0gMDtcbn07XG4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsMEVBQTBFO0FBQzFFLFNBQVMsTUFBTSxRQUFRLGNBQWMsQ0FBQztBQUV0QyxPQUFPLE1BQU0sZUFBZSxHQUFHLENBQzdCLENBQWtDLEVBQ2xDLENBQWtDLEdBQ3RCO0lBQ1osSUFBSSxDQUFDLFlBQVksUUFBUSxFQUFFLENBQUMsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNyRCxJQUFJLENBQUMsWUFBWSxRQUFRLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3JELElBQUksQ0FBQyxZQUFZLFdBQVcsRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNqRCxJQUFJLENBQUMsWUFBWSxXQUFXLEVBQUUsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFFakQsSUFBSSxNQUFNLEdBQUcsQ0FBQyxBQUFDO0lBQ2YsSUFBSSxDQUFDLENBQUMsVUFBVSxLQUFLLENBQUMsQ0FBQyxVQUFVLEVBQUU7UUFDakMsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNOLE1BQU0sR0FBRyxDQUFDLENBQUM7S0FDWjtJQUVELElBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxDQUFFO1FBQ3JDLE1BQU0sSUFBSSxBQUFDLENBQUMsQUFBVyxDQUFDLENBQUMsQ0FBQyxHQUFHLEFBQUMsQ0FBQyxBQUFXLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDL0M7SUFFRCxPQUFPLE1BQU0sS0FBSyxDQUFDLENBQUM7Q0FDckIsQ0FBQyJ9